pathway := [16,12,7,2,1]:

 ##  Transition matrices for the fitness landscapes of the 15 drugs
 ##   computed with "Method 2" in Kristina's write-up of March 9.

interface(quiet=true):
with(linalg):

an := [ AM,AMC,AMP8X,CAZ,CEC,CPD,CPR,CRO,CTT,CTX, CXM,  FEP,  SAM,TZP,ZOX]: 

labels2 := [
[0,0,0,0],[1,0,0,0],[0,1,0,0],[0,0,1,0],
[0,0,0,1],[1,1,0,0],[1,0,1,0],[1,0,0,1],
[0,1,1,0],[0,1,0,1],[0,0,1,1],[1,1,1,0],
[1,1,0,1],[1,0,1,1],[0,1,1,1],[1,1,1,1]]:

M1 := array([
[0, 0, 0, 1/2, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[1/3, 0, 0, 0, 0, 0, 1/3, 1/3, 0, 0, 0, 0, 0, 0, 0, 0], 
[1/3, 0, 0, 0, 0, 1/3, 0, 0, 0, 1/3, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 1/3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/3, 1/3, 0, 0, 0], 
[0, 0, 0, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0], 
[0, 0, 1/3, 1/3, 0, 0, 0, 0, 0, 0, 0, 1/3, 0, 0, 0, 0], 
[0, 0, 0, 0, 1/2, 0, 0, 0, 0, 0, 0, 0, 1/2, 0, 0, 0], 
[0, 0, 0, 1/3, 1/3, 0, 0, 0, 0, 0, 0, 0, 0, 1/3, 0, 0], 
[0, 0, 0, 0, 0, 0, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 1/2], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 1/2, 0, 0, 0, 0, 0, 0, 0, 1/2], 
[0, 0, 0, 0, 0, 0, 0, 0, 1/4, 1/4, 1/4, 0, 0, 0, 0, 1/4], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0]]):



M2 := array([
[0, 0, 1/2, 0, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[1/2, 0, 0, 0, 0, 0, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[1/3, 0, 0, 0, 0, 0, 1/3, 0, 0, 0, 1/3, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0], 
[0, 1/3, 1/3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/3, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0], 
[0, 1/4, 0, 0, 1/4, 0, 0, 0, 0, 0, 0, 0, 1/4, 1/4, 0, 0], 
[0, 0, 1/3, 1/3, 0, 0, 0, 0, 0, 0, 0, 1/3, 0, 0, 0, 0], 
[0, 0, 1/3, 0, 1/3, 0, 0, 0, 0, 0, 0, 0, 1/3, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 1/3, 1/3, 0, 0, 0, 0, 0, 0, 0, 0, 1/3], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0, 0, 0, 0, 1/2], 
[0, 0, 0, 0, 0, 0, 0, 0, 1/4, 1/4, 1/4, 0, 0, 0, 0, 1/4], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0]]):

M3 := array([
[0, 0, 1/3, 1/3, 1/3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[1/3, 0, 0, 0, 0, 1/3, 0, 1/3, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 1/3, 0, 0, 1/3, 1/3, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0, 1/2, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 1/3, 0, 1/3, 1/3, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0], 
[0, 1/4, 0, 1/4, 0, 0, 0, 0, 0, 0, 0, 1/4, 0, 1/4, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 1/3, 0, 0, 1/3, 0, 0, 0, 0, 0, 0, 1/3], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0, 0, 0, 0, 0, 1/2], 
[0, 0, 0, 0, 0, 0, 0, 1/3, 0, 0, 1/3, 0, 0, 0, 0, 1/3], 
[0, 0, 0, 0, 0, 0, 0, 0, 1/4, 1/4, 1/4, 0, 0, 0, 0, 1/4], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]]):

M4 := array([
[0, 0, 0, 1/2, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[1/4, 0, 0, 0, 0, 1/4, 1/4, 1/4, 0, 0, 0, 0, 0, 0, 0, 0], 
[1/4, 0, 0, 0, 0, 1/4, 0, 0, 1/4, 1/4, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0, 1/2, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 1/2, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 1/2, 0, 0, 0], 
[0, 0, 0, 1/2, 0, 0, 0, 0, 0, 0, 0, 1/2, 0, 0, 0, 0], 
[0, 0, 0, 0, 1/3, 0, 0, 0, 0, 0, 0, 0, 1/3, 1/3, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 1/3, 0, 0, 0, 1/3, 0, 0, 0, 0, 1/3], 
[0, 0, 0, 0, 0, 0, 0, 0, 1/4, 1/4, 1/4, 0, 0, 0, 0, 1/4], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 1/2, 0, 0, 0]]):
                                       
M5 := array([
[0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[1/3, 0, 0, 0, 0, 1/3, 1/3, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0], 
[1/3, 0, 0, 0, 0, 0, 1/3, 0, 1/3, 0, 0, 0, 0, 0, 0, 0], 
[1/2, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0, 0, 0, 0, 0, 0], 
[0, 0, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0], 
[0, 1/2, 0, 0, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 1/2, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 1/4, 0, 1/4, 0, 1/4, 0, 0, 0, 0, 0, 1/4], 
[0, 0, 0, 0, 0, 0, 1/4, 1/4, 0, 0, 1/4, 0, 0, 0, 0, 1/4], 
[0, 0, 0, 0, 0, 0, 0, 0, 1/4, 1/4, 1/4, 0, 0, 0, 0, 1/4], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0]]):
                                       
M6 := array([
[0, 0, 1/2, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[1/3, 0, 0, 0, 0, 1/3, 1/3, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 1/2, 1/2, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 1/2, 0, 1/2, 0, 0, 0, 0, 0, 0, 0], 
[1/4, 0, 0, 0, 0, 0, 0, 1/4, 0, 1/4, 1/4, 0, 0, 0, 0, 0], 
[0, 0, 1/3, 0, 0, 0, 0, 0, 0, 0, 0, 1/3, 1/3, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 1/3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/3, 1/3, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 
[0, 0, 0, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0], 
[0, 0, 0, 0, 0, 0, 1/3, 0, 1/3, 0, 0, 0, 0, 0, 0, 1/3], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0, 0, 0, 0, 0, 1/2], 
[0, 0, 0, 0, 0, 0, 1/3, 0, 0, 0, 1/3, 0, 0, 0, 0, 1/3], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]]):

M7 := array([
[0, 0, 1/2, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0, 1/2, 0, 0, 0, 0, 0], 
[1/3, 0, 0, 0, 0, 0, 0, 0, 0, 1/3, 1/3, 0, 0, 0, 0, 0], 
[0, 1/4, 1/4, 0, 0, 0, 0, 0, 0, 0, 0, 1/4, 1/4, 0, 0, 0], 
[0, 1/4, 0, 1/4, 0, 0, 0, 0, 0, 0, 0, 1/4, 0, 1/4, 0, 0], 
[0, 1/2, 0, 0, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 
[0, 0, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 1/3, 0, 1/3, 0, 0, 0, 0, 0, 1/3], 
[0, 0, 0, 0, 0, 0, 0, 1/3, 0, 0, 1/3, 0, 0, 0, 0, 1/3], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0, 0, 1/2, 0]]):
                                       
M8 := array([
[0, 0, 1/2, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[1/3, 0, 0, 0, 0, 1/3, 1/3, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 1/2, 0, 1/2, 0, 0, 0, 0, 0, 0, 0], 
[1/4, 0, 0, 0, 0, 0, 0, 1/4, 0, 1/4, 1/4, 0, 0, 0, 0, 0], 
[0, 0, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 1/3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/3, 1/3, 0, 0], 
[0, 0, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0, 0], 
[0, 0, 0, 0, 0, 0, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 1/2], 
[0, 0, 0, 0, 0, 1/3, 0, 0, 0, 1/3, 0, 0, 0, 0, 0, 1/3], 
[0, 0, 0, 0, 0, 0, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 1/2], 
[0, 0, 0, 0, 0, 0, 0, 0, 1/4, 1/4, 1/4, 0, 0, 0, 0, 1/4], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]]):
                                       
M9 := array([
[0, 1/3, 1/3, 1/3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 1/3, 0, 1/3, 0, 1/3, 0, 0, 0, 0, 0], 
[1/3, 0, 0, 0, 0, 0, 0, 1/3, 0, 0, 1/3, 0, 0, 0, 0, 0], 
[0, 1/4, 1/4, 0, 0, 0, 0, 0, 0, 0, 0, 1/4, 1/4, 0, 0, 0], 
[0, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0, 0, 0, 0], 
[0, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0, 0, 0], 
[0, 0, 1/3, 0, 0, 0, 0, 0, 0, 0, 0, 1/3, 0, 0, 1/3, 0], 
[0, 0, 1/4, 0, 1/4, 0, 0, 0, 0, 0, 0, 0, 1/4, 0, 1/4, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 1/4, 1/4, 0, 0, 1/4, 0, 0, 0, 0, 1/4], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/3, 1/3, 0, 1/3, 0]]):
                                       
M10 := array([
[0, 1/3, 1/3, 1/3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 1/2, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 1/2, 1/2, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 1/2, 0, 1/2, 0, 0, 0, 0, 0, 0, 0], 
[1/4, 0, 0, 0, 0, 0, 0, 1/4, 0, 1/4, 1/4, 0, 0, 0, 0, 0], 
[0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 1/3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/3, 1/3, 0], 
[0, 0, 0, 0, 0, 1/4, 1/4, 0, 1/4, 0, 0, 0, 0, 0, 0, 1/4], 
[0, 0, 0, 0, 0, 1/4, 0, 1/4, 0, 1/4, 0, 0, 0, 0, 0, 1/4], 
[0, 0, 0, 0, 0, 0, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 1/2], 
[0, 0, 0, 0, 0, 0, 0, 0, 1/3, 1/3, 0, 0, 0, 0, 0, 1/3], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]]):
                                       
M11 := array([
[0, 0, 1/2, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[1/4, 0, 0, 0, 0, 1/4, 1/4, 1/4, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0, 1/2, 0, 0, 0, 0, 0], 
[1/3, 0, 0, 0, 0, 0, 0, 0, 0, 1/3, 1/3, 0, 0, 0, 0, 0], 
[0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0, 0], 
[0, 0, 0, 0, 1/3, 0, 0, 0, 0, 0, 0, 0, 1/3, 1/3, 0, 0], 
[0, 0, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0], 
[0, 0, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 1/2, 0], 
[0, 0, 0, 0, 0, 1/4, 1/4, 0, 1/4, 0, 0, 0, 0, 0, 0, 1/4], 
[0, 0, 0, 0, 0, 1/3, 0, 0, 0, 1/3, 0, 0, 0, 0, 0, 1/3], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0]]):
                                       
M12 := array([
[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[1/4, 0, 0, 0, 0, 1/4, 1/4, 1/4, 0, 0, 0, 0, 0, 0, 0, 0], 
[1/4, 0, 0, 0, 0, 1/4, 0, 0, 1/4, 1/4, 0, 0, 0, 0, 0, 0], 
[1/4, 0, 0, 0, 0, 0, 1/4, 0, 1/4, 0, 1/4, 0, 0, 0, 0, 0], 
[1/3, 0, 0, 0, 0, 0, 0, 0, 0, 1/3, 1/3, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 1/2, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 1/3, 0, 0, 0, 0, 0, 0, 0, 1/3, 1/3, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 1/2], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], 
[0, 0, 0, 0, 0, 0, 1/3, 0, 0, 0, 1/3, 0, 0, 0, 0, 1/3], 
[0, 0, 0, 0, 0, 0, 0, 0, 1/4, 1/4, 1/4, 0, 0, 0, 0, 1/4], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]]):
                                       
M13 := array([
[0, 1/3, 1/3, 0, 1/3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 1/3, 1/3, 1/3, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[1/3, 0, 0, 0, 0, 0, 1/3, 0, 0, 0, 1/3, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 1/2, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0, 1/2, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 1/2, 0, 0], 
[0, 0, 1/4, 1/4, 0, 0, 0, 0, 0, 0, 0, 1/4, 0, 0, 1/4, 0], 
[0, 0, 1/3, 0, 1/3, 0, 0, 0, 0, 0, 0, 0, 1/3, 0, 0, 0], 
[0, 0, 0, 0, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0, 0, 0, 0, 1/2], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]]):
                                       
M14 := array([
[0, 1/3, 1/3, 0, 1/3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[1/3, 0, 0, 0, 0, 0, 0, 0, 1/3, 0, 1/3, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0], 
[0, 1/3, 1/3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/3, 0, 0, 0], 
[0, 1/3, 0, 1/3, 0, 0, 0, 0, 0, 0, 0, 1/3, 0, 0, 0, 0], 
[0, 1/3, 0, 0, 1/3, 0, 0, 0, 0, 0, 0, 0, 1/3, 0, 0, 0], 
[0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 1/4, 0, 1/4, 0, 0, 0, 0, 0, 0, 0, 1/4, 0, 1/4, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 1/2, 0, 0, 1/2, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 1/4, 1/4, 0, 0, 1/4, 0, 0, 0, 0, 1/4], 
[0, 0, 0, 0, 0, 0, 0, 0, 1/3, 0, 1/3, 0, 0, 0, 0, 1/3], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 1/2, 0, 0, 0]]):
                                       
M15 := array([
[0, 1/3, 1/3, 1/3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 1/3, 1/3, 1/3, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 1/2, 1/2, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0], 
[1/4, 0, 0, 0, 0, 0, 0, 1/4, 0, 1/4, 1/4, 0, 0, 0, 0, 0], 
[0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 
[0, 0, 0, 1/2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/2, 0], 
[0, 0, 0, 0, 0, 1/4, 1/4, 0, 1/4, 0, 0, 0, 0, 0, 0, 1/4], 
[0, 0, 0, 0, 0, 1/4, 0, 1/4, 0, 1/4, 0, 0, 0, 0, 0, 1/4], 
[0, 0, 0, 0, 0, 0, 1/4, 1/4, 0, 0, 1/4, 0, 0, 0, 0, 1/4], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0]]):


treatment := []:
treatprob := []:
for i from 1 to nops(pathway)-1 do
a := pathway[i]:
b := pathway[i+1]:
winners := {}:
winvalu := 0:
for j from 1 to 15 do
if (cat(M,j)[a,b] > winvalu) then winners := {an[j]}: winvalu := cat(M,j)[a,b]:fi:
if (cat(M,j)[a,b] = winvalu) then winners := winners union {an[j]}: fi:
od:
treatment := [treatment[],winners]:
treatprob := [treatprob[],winvalu]:
od:

pathw := []:
for i from 1 to nops(pathway) do
pathw := [pathw[],cat(labels2[pathway[i]][])]:od:

pathw;
treatment;
treatprob;
